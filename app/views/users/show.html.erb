<% provide(:title, @user.first_name) %>
<section class="container-fluid">
  <!--Tab feeds va discover-->
  <div class="row">
    <%= render 'layouts/tab_feeds' %>
    <article class="tab-content col-md-8 p-0 mt-3  bg-white" >
      <!--tab profile-->
      <div class="container-fluid p-0">
        <div class="row m-3">
          <img src="<%= @user.avatar %>" class="rounded-circle mr-2 sizeMyPhotos" id="avatarMain" >
          <div>
            <%= render 'follow_form'%>
            <h1 class="mt-3"><b><%= @user.first_name %> <%= @user.last_name %></b></h1>
            <!-- Nav profile tabs -->
            <ul class="nav nav-tabs mt-3">
              <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#photosProfile"><b><%= @user.photos.count%></b><small> <b>PHOTOS</b></small></a>
              </li>
              <li class="nav-item d-inline-flex">
                <a class="nav-link" data-toggle="tab" href="#albumsProfile"><b><%= @user.albums.count %></b><small> <b>ALBUMS</b></small></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#followingsProfile" id="followingT-<%= @user.id %>"><b><%= @user.following.count %></b><small> <b>FOLLOWINGS</b></small></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#followersProfile" id="followersT-<%= @user.id %>"><b><%= @user.followers.count %></b><small> <b>FOLLOWERS</b></small></a>
              </li>
            </ul>
          </div>
        </div>
      </div>

    <!--show content-->

      <div class="tab-content container-fluid p-4 ml-0">
        <div id="photosProfile" class=" tab-pane active">
          <%if current_user.id == @user.id %>
            <div class="row d-flex flex-row-reverse p-3">
              <a class="btn btn-success float-right btnRadius" href="/photos/new"><b>Add Photo</b></a>
            </div>
          <% end %>
          <div class="row">
            <% @user.photos.each do |photo| %>
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 text-center sizeFramePhotos">
              <div class="d-flex justify-content-center text-center sizeImage">
                <%= image_tag photo.image , {class:"rounded-sm sizePhotos", style:"position: absolute; z-index: 0;"} if photo.image.attached?%>
                <% if photo.sharing_mode? %>
                  <i class="fas fa-unlock fa-lg rounded-circle bg-secondary p-2 mt-1" style="position: absolute; z-index: 1; margin-left: 177px; opacity: 0.6;"></i>
                  <% else %>
                  <i class="fas fa-lock fa-lg rounded-circle bg-secondary p-2 mt-1" style="position: absolute; z-index: 1; margin-left: 177px; opacity: 0.6;"></i>
                <% end %>
                <%if current_user.id == @user.id %>
                  <%= link_to 'EDIT', edit_photo_path(photo), class:"btn btn-secondary", style:"position: absolute; z-index: 2; margin-top: 178px; margin-left: 148px; opacity: 0.6;" %>
                <% end %>
              </div>
              <div class="d-flex justify-content-center">
                <p><%= photo.title %></p>
              </div>
            </div>
          <% end %>
          </div>
        </div><!--end tab show photo-->
        <div id="albumsProfile" class="tab-pane fade">
          <%if current_user.id == @user.id %>
            <div class="row d-flex flex-row-reverse p-3">
              <a class="btn btn-success float-right btnRadius" href="/albums/new"><b>Add Albums</b></a>
            </div>
          <% end %>
          <div class="row">
            <% @user.albums.each do |album| %>
              <div class="col-12 col-sm-6 col-md-4 col-lg-3 text-center sizeFramePhotos">
                <div class="d-flex justify-content-center m-0 text-center sizeImage">
                  <% album.images.each_with_index do |photo, index| %>
                      <% if (index +1 == album.images.length) %>
                        <%= image_tag photo, {class:"rounded-sm sizeAlbums", style:"position: absolute; z-index: index;"} %>
                      <% else %>
                        <% a = (index*5+5).to_s %>
                        <%= image_tag photo, {class:"rounded-sm sizeAlbums", style:"position: absolute; z-index: index; transform: rotate("+ a +"deg)"} %>
                      <% end %>
                  <% end %>
                  <p class="rounded-circle bg-secondary p-3" style="position: absolute; z-index: <%= album.images.length %> + 1; margin-top: 70px;"><b><%= album.images.length %><br><small>PHOTOS</small></b></p>
                  <% if album.sharing_mode? %>
                    <i class="fa fa-unlock fa-lg rounded-circle bg-secondary p-2 mt-1" style="position: absolute; z-index: <%= album.images.length %> + 2; margin-left: 176px; margin-top: 5px;"></i>
                    <% else %>
                    <i class="fa fa-lock fa-lg rounded-circle bg-secondary p-2 mt-1" style="position: absolute; z-index: <%= album.images.length %> + 2; margin-left: 176px; margin-top: 5px;"></i>
                  <% end %>
                  <%if current_user.id == @user.id %>
                    <a class="btn btn-secondary" style="position: absolute; z-index: <%= album.images.length %> + 3; margin-top: 178px; margin-left: 147px; float: right;" href="edit_album_path(user)">EDIT</a>
                    <% end %>
                </div>
                <div class="d-flex justify-content-center">
                  <p><%= album.title %></p>
                </div>
              </div>
            <% end %>
          </div>
        </div>
        <!--end tab show album-->
        <div id="followingsProfile" class="tab-pane fade">
          <div class="row" id="moreFollowing-<%= @user.id %>">
            <% @user.following.each do |user| %>
              <%= link_to user do %>
                <div class="col-12 col-sm-6 col-lg-3 p-1" id="following-<%= user.id %>-in-<%= @user.id %>">
                  <div class="card rounded-sm">
                    <div class="d-flex justify-content-center mt-3">
                      <img class="card-img-top rounded-circle" src="<%= user.avatar.url() %>" alt="Card image" style="width: 150px; height: 150px;">
                    </div>
                    <div class="card-body text-center" style="height: 230px;">
                      <h4 class="card-title"><b><%= user.first_name %> <%= user.last_name %> </b></h4>
                      <ul class="nav d-inline-flex">
                        <li class="m-2">
                          <a class="nav-link" data-toggle="tab" href="#"><b><%= user.photos.count %><br><small>PHOTOS</small></b></a>
                        </li>
                        <li class="m-2">
                          <a class="nav-link" data-toggle="tab" href="#"><b><%= user.albums.count %><br><small>ALBUMS</small></b></a>
                        </li>
                      </ul>
                      <%unless current_user.id == user.id %>
                        <div id="following_form-<%= user.id %>">
                          <% if current_user.following?(user) %>
                            <%= form_for(current_user.active_relationships.find_by(followed_id: user.id),
                                         html: { method: :delete },
                                         remote: true) do |f| %>
                              <%= f.submit "Unfollow", class: "btn btn-warning mt-4 btnRadius", style:"border: 3px solid #ff8d00;" %>
                            <% end %>
                          <% else %>
                            <%= form_for(current_user.active_relationships.build, remote: true) do |f| %>
                              <div><%= hidden_field_tag :followed_id, user.id %></div>
                              <%= f.submit "Follow", class: "btn mt-4 btnRadius text-warning", style:"border: 3px solid #ff8d00;" %>
                            <% end %>
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
        <!--end tab show followings-->
        <div id="followersProfile" class="tab-pane fade">
          <div class="row" id="moreFollowers-<%= @user.id %>">
            <% @user.followers.each do |user| %>
              <%= link_to user do %>
                <div class="col-12 col-sm-6 col-lg-3 p-1 %>" id="follower-<%= user.id %>-in-<%= @user.id %>">
                  <div class="card rounded-sm">
                    <div class="d-flex justify-content-center mt-3">
                      <img class="card-img-top rounded-circle" src="<%= user.avatar.url() %>" alt="Card image" style="width: 150px; height: 150px;">
                    </div>
                    <div class="card-body text-center" style="height: 230px;">
                      <h4 class="card-title"><b><%= user.first_name %> <%= user.last_name %> </b></h4>
                      <ul class="nav d-inline-flex">
                        <li class="m-2">
                          <a class="nav-link" data-toggle="tab" href="user_path(user)"><b><%= user.photos.count %><br><small>PHOTOS</small></b></a>
                        </li>
                        <li class="m-2">
                          <a class="nav-link" data-toggle="tab" href="user_path(user)"><b><%= user.albums.count %><br><small>ALBUMS</small></b></a>
                        </li>
                      </ul>
                      <%unless current_user.id == user.id %>
                        <div id="follower_form-<%= user.id %>">
                          <% if current_user.following?(user) %>
                            <%= form_for(current_user.active_relationships.find_by(followed_id: user.id),
                                         html: { method: :delete },
                                         remote: true) do |f| %>
                              <%= f.submit "Unfollow", class: "btn btn-warning mt-4 btnRadius", style:"border: 3px solid #ff8d00;" %>
                            <% end %>
                          <% else %>
                            <%= form_for(current_user.active_relationships.build, remote: true) do |f| %>
                              <div><%= hidden_field_tag :followed_id, user.id %></div>
                              <%= f.submit "Follow", class: "btn mt-4 btnRadius text-warning", style:"border: 3px solid #ff8d00;" %>
                            <% end %>
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
        <!--end tab show followers-->
      </div>
      <!--end class tab-content-->
    </article>
  </div>
</section>
























